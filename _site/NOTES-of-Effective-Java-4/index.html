<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Effective Java 4 - Generics &mdash; Simple, Not Easy</title>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700|Oswald" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/main.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/images/logo.jpg"/>
    <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="Simple, Not Easy" />
    <meta name="title" content="Effective Java 4 - Generics ">
    <link rel="canonical" href="/NOTES-of-Effective-Java-4">
     
    <link rel="author" href="https://plus.google.com/118230970865161551961">       
    <meta property="og:title" content="Effective Java 4 - Generics "/>
    <meta property="og:url" content="/NOTES-of-Effective-Java-4"/>
    
    
    <meta property="og:site_name" content="Simple, Not Easy">
    <link rel="stylesheet" href="bt-responsive.css" type="text/css" media="screen" charset="utf-8">
    <meta name="keywords" content="java">
</head>
<body>
    
<section class="site-nav">
    <header>
        <nav id="navigation" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
            <a class="brand" href="/">
                <img src="/images/logo.jpg" alt="Inc">
            </a>
            <a href="/">Blog</a>
            
              <a href="/archives.html" >Archives</a>
            
              <a href="/about.html" >About</a>
            
              <a href="/tags.html" >Tags</a>
            
              <a href="http://cast.allenlsy.com" >Casts</a>
            
            <i class="icon-feed"></i> <a href="/feed.xml" title="Atom/RSS feed">Feed</a>
        </nav>

    </header>
</section>


<article>

    <div class="container">
        <header>
            <h1 class="title">Effective Java 4 - Generics</h1>
            
            <div class="meta">
                <time pubdate datetime="2013-13-May" title="May 13, 2013">May 13, 2013</time>
            </div>
            <div class="tags">
              <a href="/tags/java.html" rel="tag">java</a>
            </div>
            <div class="hidden-seo">
              By <a href="/NOTES-of-Effective-Java-4" title="Effective Java 4 - Generics" rel="author">allenlsy</a>
            </div>
        </header>

        <section>
            <p><img src="http://www.crazysmoove.com/memjug/javabooks-slides/images/Effective_Java.jpg" alt="" />
<br /></p>

<ul>
  <li><a href="#i23">23. Don’t use raw types in new code</a></li>
  <li><a href="#i24">24. Eliminate unchecked warnings</a></li>
  <li><a href="#i25">25. Prefer <code>List</code> to <code>Array</code></a></li>
  <li><a href="#i26">26. Favor generic types</a></li>
  <li><a href="#i27">27. Favor generic method</a></li>
  <li><a href="#i28">28. Use bounded wildcards to increase API flexibility</a></li>
  <li><a href="#i29">29. Consider typesafe heterogeneous containers</a></li>
</ul>

<hr />

<h2 id="i23">23. Don’t use raw types in new code</h2>

<p><strong>Raw type</strong> generics is the type without the parameterized type. For example, <code>List</code> is the raw type of <code>List&lt;E&gt;</code>.</p>

<h4 id="example-bad">Example: bad</h4>

<div class="highlight"><pre><code class="java"><span class="c1">// DON&#39;T DO THIS</span>
<span class="kd">private</span> <span class="kd">final</span> <span class="n">Collection</span> <span class="n">stamps</span> <span class="o">=</span> <span class="o">...;</span>

<span class="n">stamps</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Coin</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">stamps</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();</span> <span class="o">)</span> <span class="o">{</span>
	<span class="c1">// HERE COMES THE EXCEPTION</span>
	<span class="n">Stamp</span> <span class="n">s</span> <span class="o">=</span> <span class="o">(</span><span class="n">Stamp</span><span class="o">)</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>

<p>Replace the first line with: </p>

<div class="highlight"><pre><code class="java"><span class="kd">private</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Stamp</span><span class="o">&gt;</span> <span class="n">stamps</span> <span class="o">=</span> <span class="o">...;</span>
</code></pre></div>

<p>Using raw type will lose the security advantage of generics. Then why Java allow raw types? For historical reasons.</p>

<h4 id="difference-between-list-and-listobject">Difference between <code>List</code> and <code>List&lt;Object&gt;</code></h4>

<p><code>List</code>, code likes this is avoiding type checking.</p>

<p>If <code>List lst</code>, <code>List&lt;Object&gt; lst1</code>, <code>List&lt;String&gt; lst2</code>, then <code>lst = lst2</code> is valid, but <code>lst1 = lst2</code> is invalid. <code>List&lt;String&gt;</code> is a subclass of <code>List</code>, but is not a subclass of <code>List&lt;Object&gt;</code>.</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
<span class="o">{</span>
	<span class="n">List</span><span class="o">&lt;</span> <span class="n">String</span> <span class="o">&gt;</span> <span class="n">strings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span> <span class="n">String</span> <span class="o">&gt;();</span>
	<span class="n">unsafeAdd</span><span class="o">(</span><span class="n">strings</span><span class="o">,</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="mi">42</span><span class="o">));</span>
	<span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">unsafeAdd</span><span class="o">(</span><span class="n">List</span> <span class="n">list</span><span class="o">,</span> <span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>

<p>Program will receive a warning at <code>list.add(o)</code>. I know you want to allow the element to be any type. You can use <code>List&lt;?&gt;</code> instead of <code>List</code> in <code>unsafeAdd</code>.</p>

<h4 id="difference-between-list-and-list">Difference between <code>List</code> and <code>List&lt;?&gt;</code></h4>

<p><code>?</code>, the <strong>unbounded wildcard type</strong>, is a safe type. <code>null</code> cannot be put into <code>Collection&lt;?&gt;</code>.</p>

<h4 id="two-exceptions-when-to-use-raw-type-in-new-code">Two exceptions: When to use raw type in new code</h4>

<p>Generics information will be erase at runtime. It only takes effect at compile time.</p>

<ol>
  <li>In class literal(like <code>List.class</code>), we must use raw type. <code>List&lt;String&gt;.class</code> and <code>List&lt;?&gt;.class</code> are invalid.</li>
  <li><code>instanceof List&lt;String&gt;</code> is invalid.</li>
</ol>

<p>Code below is a way to use <code>instanceof</code> when using generics</p>

<div class="highlight"><pre><code class="java"><span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="k">instanceof</span> <span class="n">Set</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">Set</span><span class="o">&lt;?&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="o">(</span> <span class="n">Set</span><span class="o">&lt;?&gt;</span> <span class="o">)</span> <span class="n">o</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<h4 id="some-types">Some types</h4>

<p><strong>Bounded type parameter</strong>: <code>&lt;E extends Number&gt;</code></p>

<p><strong>Recursive type bound</strong>: <code>&lt;T extends Comparable&lt;T&gt;&gt;</code></p>

<p><strong>Bounded wildcard type</strong>: <code>List&lt;? extends Number&gt;</code></p>

<p><strong>Generic method</strong>: <code>static &lt;E&gt; List&lt;E&gt; asList(E[] a)</code></p>

<h2 id="i24">24. Eliminate unchecked warnings</h2>

<p>Eliminate every unchecked warnings that you can.</p>

<p>If the warning cannot be eliminated, and you can prove the code is safe, then you can use a <code>@SuppressWarnings("unchecked")</code> annotation to eliminate the warning. </p>

<h4 id="example">Example</h4>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="o">&lt;</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T</span><span class="o">[]</span> <span class="n">toArray</span><span class="o">(</span><span class="n">T</span><span class="o">[]</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
		<span class="c1">// This cast is correct because the array we&#39;re creating</span>
		<span class="c1">// is of the same type as the one passed in, which is T[].</span>
		<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">&quot;unchecked&quot;</span><span class="o">)</span>
		<span class="n">T</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="o">(</span><span class="n">T</span><span class="o">[])</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">elements</span><span class="o">,</span> <span class="n">size</span><span class="o">,</span> <span class="n">a</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">elements</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">size</span><span class="o">);</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">size</span><span class="o">)</span>
		<span class="n">a</span><span class="o">.[</span><span class="n">size</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
	<span class="k">return</span> <span class="n">a</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<p>When using <code>@SuppressWarnings("unchecked")</code> annotation, you must comment why it is correct and safe.</p>

<h2 id="i25">25. Prefer <code>List</code> to <code>Array</code></h2>

<p>Array is <strong>covariant</strong>, which means if <code>Sub</code> is a subclass of <code>Super</code>, then <code>Sub[]</code> is a subclass of <code>Super[]</code>. </p>

<p>List is <strong>invariant</strong>.</p>

<div class="highlight"><pre><code class="java"><span class="cm">/* This compiles */</span>
<span class="n">Object</span><span class="o">[]</span> <span class="n">objectArray</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Long</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
<span class="n">objectArray</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="s">&quot;I don&#39;t fit in&quot;</span><span class="o">;</span> <span class="c1">// Throws ArrayStoreException</span>

<span class="cm">/* This will not compile */</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">ol</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span> <span class="c1">// compilation error</span>
<span class="n">ol</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;I don&#39;t fit in&quot;</span><span class="o">);</span>
</code></pre></div>

<p>This actually means, <strong>array has fault, not generics</strong>.</p>

<p><strong>Another difference between array and generics is</strong>, array does type checking during runtime, while generics does that during compilation. Array throws exception if error occurs.</p>

<p>Generics does type checking while compilation, and then use <strong>erasure</strong> to erase the parameterized type information in runtime. After erasure, generics can be used with unbounded generics.</p>

<h4 id="creating-an-array-of-a-generic-type-a-parameterized-type-or-a-type-parameter-are-illegal-because-the-type-of-array-is-not-typesafe">Creating an array of a generic type, a parameterized type or a type parameter are illegal, because the type of array is not typesafe</h4>

<p>This code is illegal</p>

<div class="highlight"><pre><code class="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;[]</span> <span class="n">stringLists</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;[</span><span class="mi">1</span><span class="o">];</span> <span class="c1">// This one won&#39;t compile</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">intList</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">42</span><span class="o">);</span>
<span class="n">Object</span><span class="o">[]</span> <span class="n">object</span> <span class="o">=</span> <span class="n">stringLists</span><span class="o">;</span>
<span class="n">objects</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">intList</span><span class="o">;</span>
<span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">stringList</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</code></pre></div>

<p>If 1st line is correct, then 3rd line, it is correct, because at runtime, <code>stringList</code> is just <code>List</code> after erasure. Then 4th line, it is equivalent to the first element of <code>List</code> is a <code>List</code>(after erasure, but actually it is <code>List&lt;Integer&gt;</code>. 4th line is legal. But 5th line is illegal, we cannot get s, since it is a <code>Integer</code> 42.</p>

<p>Things like <code>E</code>, <code>List&lt;E&gt;</code>, <code>List&lt;String&gt;</code> is <strong>non-reifiable</strong> type, which is a type that at runtime the information in the memory representation is little than compilation time. <code>List&lt;?&gt;</code> is legal.</p>

<p><strong>Solution</strong> is prefer <code>List&lt;E&gt;</code> instead of <code>E[]</code>. Less performance and simplexity, more secure and flexibility.</p>

<div class="highlight"><pre><code class="java"><span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">E</span> <span class="n">reduce</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">f</span><span class="o">,</span> <span class="n">E</span> <span class="n">initVal</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">E</span><span class="o">[]</span> <span class="n">snapshot</span> <span class="o">=</span> <span class="o">(</span><span class="n">E</span><span class="o">[])</span> <span class="n">list</span><span class="o">.</span><span class="na">toArray</span><span class="o">();</span> <span class="c1">// Locks list</span>
	<span class="n">E</span> <span class="n">result</span> <span class="o">=</span> <span class="n">initVal</span><span class="o">;</span>
	<span class="k">for</span> <span class="o">(</span><span class="n">E</span> <span class="n">e</span> <span class="o">:</span> <span class="n">snapshot</span><span class="o">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">result</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
	<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<p>It has a warning <code>[unchecked] unchecked cast</code>. <code>toArray()</code> returns a Object[], casting to <code>E[]</code> is dangerous.</p>

<p><strong>Solution</strong> is:</p>

<div class="highlight"><pre><code class="java"><span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">E</span> <span class="n">reduce</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Function</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">f</span><span class="o">,</span> <span class="n">E</span> <span class="n">initVal</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">snapshot</span><span class="o">;</span>
	<span class="kd">synchronized</span><span class="o">(</span><span class="n">list</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">snapshot</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;(</span><span class="n">list</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="n">E</span> <span class="n">result</span> <span class="o">=</span> <span class="n">initVal</span><span class="o">;</span>
	<span class="k">for</span> <span class="o">(</span><span class="n">E</span> <span class="n">e</span> <span class="o">:</span> <span class="n">snapshot</span><span class="o">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">result</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
	<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<h2 id="i26">26. Favor generic types</h2>

<p>We are programming a Stack class, <code>public class Stack&lt;E&gt;</code>. </p>

<p>You may want to store the element in an array like <code>private E[] elements</code> inside the class. In the constructor, when you initialize <code>elements</code>, you will get a warning or error on <code>elements = new E[DEFAULT_INITIAL_CAPACITY]</code>. Because you cannot create a <strong>non-reifiable</strong> type array.</p>

<p>There are two ways to solve this.</p>

<h4 id="solution-1">Solution 1</h4>

<p>Initialize <code>elements = (E[]) new Object[DEFAULT_INITIAL_CAPACITY]</code>. You will get another warning says <code>unchecked cast</code>. The compiler cannot guarantee the casting is correct. You can use a <code>@SuppressWarnings("unchecked")</code> to avoid the warning. </p>

<h4 id="solution-2">Solution 2</h4>

<p>Change the type of <code>elements</code> to <code>Object[] elements</code>. Then you may get error when you do stack operations like on <code>E result = elements[--size]</code> you will get <code>incompatible types</code>. If you change it to <code>E result = (E) elements[--size]</code>, you will get a warning <code>unchecked cast</code>. Since <code>E</code> is a non-reifiable type, the compiler cannot to type checking when casting. Still you can use <code>@SuppressWarnings("unchecked")</code>.</p>

<h4 id="summary">Summary</h4>

<p>Both solutions are ok. The difference is that first solution will annotate a whole array as <code>@SuppressWarnings</code>, which is more dangerous than the second solution. Thus the second one is better. But the second solution may require a lot of type casting to <code>E</code>,. That’s why the first solution is more common in use.</p>

<p>Final code(using solution 1):</p>

<div class="highlight"><pre><code class="java"><span class="c1">// ... explain why you can suppress the warnings</span>
<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">&quot;unchecked&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Stack</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">elements</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DEFAULT_INITIAL_CAPACITY</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nf">Stack</span> <span class="o">()</span> <span class="o">{</span>
		<span class="n">elements</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">DEFAULT_INIT_CAPACITY</span><span class="o">];</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">Object</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">ensureCapacity</span><span class="o">();</span>
		<span class="n">elements</span><span class="o">[</span><span class="n">size</span><span class="o">++]</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Object</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">EmptyStackException</span><span class="o">();</span>
		<span class="n">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">elements</span><span class="o">[--</span><span class="n">size</span><span class="o">];</span>
		<span class="n">elements</span><span class="o">[</span><span class="n">size</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">ensureCapacity</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">elements</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="n">size</span><span class="o">)</span>
			<span class="n">elements</span><span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">elements</span><span class="o">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<h2 id="i27">27. Favor generic method</h2>

<h4 id="example-of-generic-method">Example of generic method</h4>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">union</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">s1</span><span class="o">,</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;(</span><span class="n">s1</span><span class="o">);</span>
	<span class="n">result</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">s2</span><span class="o">);</span>
	<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<p>You can use bounded wildcard type to make it more flexible.</p>

<hr />

<p>Generic has a mechanism called <strong>type inference</strong>. It will know what is the generic type you want to use.</p>

<p>There is a redundant in declaration of a generic object. <code>Map&lt;String, List&lt;String&gt;&gt; anagrams = new HashMap&lt;String, List&lt;String&gt;&gt;()</code>, the left side and right side both need the full type parameters. We can have a <strong>generic static factory method</strong> to do it.</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">newHashMap</span><span class="o">()</span> <span class="o">{</span>
	<span class="k">return</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span>
<span class="o">}</span>

<span class="c1">// calling the method </span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">anagrams</span> <span class="o">=</span> <span class="n">newHashMap</span><span class="o">();</span> <span class="c1">// The type is inferenced from the return type</span>
</code></pre></div>

<h4 id="example-generic-singleton-factory">Example: generic singleton factory</h4>

<p>If the object we generate from the generic static factory is a singleton, since generics use erasure mechanism, we may need to create many different types of singletons. </p>

<p>Suppose we have an interface</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UnaryFunction</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
	<span class="n">T</span> <span class="nf">apply</span><span class="o">(</span><span class="n">T</span> <span class="n">arg</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>

<p>Now we need an identity function, implement this <code>UnaryFunction</code>, we may need create a new one every time we use it for a new type.</p>

<p>The whole program:</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UnaryFunction</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
	<span class="n">T</span> <span class="nf">apply</span><span class="o">(</span><span class="n">T</span> <span class="n">arg</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span>
<span class="o">{</span>
	<span class="c1">// Generic singleton factory pattern</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="n">UnaryFunction</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">IDENTITY_FUNCTION</span> <span class="o">=</span> 
		<span class="k">new</span> <span class="n">UnaryFunction</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;()</span> <span class="o">{</span>
			<span class="kd">public</span> <span class="n">Object</span> <span class="nf">apply</span><span class="o">(</span><span class="n">Object</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span> <span class="k">return</span> <span class="n">arg</span><span class="o">;</span> <span class="o">}</span>
	<span class="o">};</span>

	<span class="c1">// IDENTITY_FUNCTION is stateless and its type parameter is</span>
	<span class="c1">// unbounded so it&#39;s safe to share one instance across all types</span>
	<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">&quot;unchecked&quot;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">UnaryFunction</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">identityFunction</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="o">(</span><span class="n">UnaryFunction</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;)</span> <span class="n">IDENTITY_FUNCTION</span><span class="o">;</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&quot;jute&quot;</span><span class="o">,</span> <span class="s">&quot;hemp&quot;</span><span class="o">,</span> <span class="s">&quot;nylon&quot;</span> <span class="o">};</span>
		<span class="n">UnaryFunction</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">sameString</span> <span class="o">=</span> <span class="n">identityFunction</span><span class="o">();</span>
		<span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">strings</span><span class="o">)</span> 
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sameString</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">s</span><span class="o">));</span>

		<span class="n">Number</span><span class="o">[]</span> <span class="n">numbers</span> <span class="o">=</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mf">2.0</span><span class="o">,</span> <span class="mi">3L</span> <span class="o">};</span>
		<span class="n">UnaryFunction</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">sameNumber</span> <span class="o">=</span> <span class="n">identityFunction</span><span class="o">();</span>
		<span class="k">for</span> <span class="o">(</span><span class="n">Number</span> <span class="n">n</span> <span class="o">:</span> <span class="n">numbers</span><span class="o">)</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sameNumber</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">n</span><span class="o">));</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div>

<p>This one will have an warning, since not all the <code>IDENTITY_FUNCTION</code> can be casted to <code>UnaryFunction&lt;T&gt;</code>. But we know it is safe here. </p>

<h4 id="example-recursive-type-bound">Example: recursive type bound</h4>

<p>How to express the constraint that in a list, every element is able to compare with another element in the list. For example, to get the maximum element from this type of list:</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="n">max</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span> 
	<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
	<span class="n">T</span> <span class="n">result</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
	<span class="k">while</span> <span class="o">(</span><span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
		<span class="n">T</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">result</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<p>By doing so we ensure that type <code>T</code> is able to compare with the same type object.</p>

<h2 id="i28">28. Use bounded wildcards to increase API flexibility</h2>

<p>We have a piece of code:</p>

<div class="highlight"><pre><code class="java"><span class="n">Stack</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">numberstack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Stack</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;();</span>
<span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">integers</span> <span class="o">=</span> <span class="o">...</span> <span class="o">;</span>
<span class="n">numberStack</span><span class="o">.</span><span class="na">pushAll</span><span class="o">(</span><span class="n">integers</span><span class="o">);</span>
</code></pre></div>

<p>You cannot push <code>integers</code> into <code>numberStack</code> because the types are not match. </p>

<p>After using bounded wildcard:</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">pushAll</span><span class="o">(</span><span class="n">Iterable</span><span class="o">&lt;</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">E</span><span class="o">&gt;</span> <span class="n">src</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">for</span> <span class="o">(</span><span class="n">E</span> <span class="n">e</span> <span class="o">:</span> <span class="n">src</span><span class="o">)</span>
		<span class="n">push</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>

<p>If you also want a <code>popAll</code>:</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">popAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span> <span class="o">?</span> <span class="kd">super</span> <span class="n">E</span><span class="o">&gt;</span> <span class="n">dst</span><span class="o">)</span>
<span class="o">{</span>
	<span class="k">while</span> <span class="o">(!</span><span class="n">isEmpty</span><span class="o">())</span>
		<span class="n">dst</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">pop</span><span class="o">());</span>

<span class="o">}</span>
</code></pre></div>

<p>Pay attention to <code>Collection&lt; ? super E&gt;</code>.</p>

<p><strong>For maximum flexibility, use wildcard types on input parameters that represent producers or consumers.</strong></p>

<p><strong>PECS</strong>: producer-extends, consumer-super. <em>producer</em> provides things, will not change itself. <em>consumer</em> use things, will change itself. So in previous example,, dst use the object from stack, it is a consumer.</p>

<h4 id="example-1">Example</h4>

<p>Apply PECS to the stack example in section 27: </p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">union</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">E</span> <span class="o">&gt;</span> <span class="n">s1</span><span class="o">,</span> <span class="n">Set</span><span class="o">&lt;</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">E</span> <span class="o">&gt;</span> <span class="n">s2</span><span class="o">)</span> <span class="o">{</span> <span class="o">..</span> <span class="o">}</span>

<span class="n">Set</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">integers</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">&gt;</span> <span class="n">doubles</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">Set</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">union</span><span class="o">(</span><span class="n">integers</span><span class="o">,</span> <span class="n">doubles</span><span class="o">);</span>
</code></pre></div>

<p>Notice that the return type of <code>union</code> is <code>Set&lt;E&gt;</code>.</p>

<p>Unfortunately, You will get an error: <code>incompatible types</code>. Because compiler cannot inference your type <code>E</code>.</p>

<p>The Solution is <strong>explicit type parameter</strong>. If the compiler cannot infer the correct type, we can try this.</p>

<div class="highlight"><pre><code class="java"><span class="n">Set</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="n">Union</span><span class="o">.&lt;</span><span class="n">Number</span><span class="o">&gt;</span><span class="n">union</span><span class="o">(</span><span class="n">integers</span><span class="o">,</span> <span class="n">doubles</span><span class="o">);</span>
</code></pre></div>

<h4 id="more-examples-recursive-type-bound">More examples: recursive type bound</h4>

<p>Let’s look back at the <code>max()</code> int section 27. Apply PECS to that. Previous method is:</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">T</span> <span class="n">max</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span>
</code></pre></div>

<p>Now become:</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;</span> <span class="o">?</span> <span class="kd">super</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">T</span> <span class="n">max</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
	<span class="n">T</span> <span class="n">result</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
	<span class="k">while</span><span class="o">(</span> <span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
		<span class="n">T</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">result</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>

<p>But it has a compilation error. It says <code>list</code> is not a <code>List&lt;T&gt;</code>. We need to replace the iterator with <code>Iterator&lt; ? extends T &gt; i= list.iterator()</code>.</p>

<h2 id="i29">29. Consider typesafe heterogeneous containers</h2>

<p>In Java 1.5, <code>Class</code> type becomes <code>Class&lt;T&gt;</code>. <code>String.class</code> returns a value of type <code>Class&lt;String&gt;</code>.</p>

<p>We have a <code>Favorites</code> class, to store one single favorite object for each type of things.</p>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Favorites</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span> <span class="n">Class</span><span class="o">&lt;</span> <span class="o">?</span> <span class="o">&gt;,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">favorites</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span> <span class="n">Class</span><span class="o">&lt;</span> <span class="o">?</span> <span class="o">&gt;,</span> <span class="n">Object</span><span class="o">&gt;();</span>

	<span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="n">putFavorite</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">,</span> <span class="n">T</span> <span class="n">instance</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">NullPointerException</span><span class="o">(</span><span class="s">&quot;Type is null&quot;</span><span class="o">);</span>
		<span class="n">favorites</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">instance</span><span class="o">);</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="n">getFavorite</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">type</span><span class="o">.</span><span class="na">cast</span><span class="o">(</span><span class="n">favorites</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">type</span><span class="o">));</span>
	<span class="o">}</span>
<span class="o">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">Favorites</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Favorites</span><span class="o">();</span>
	<span class="n">f</span><span class="o">.</span><span class="na">putFavorite</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">&quot;Java&quot;</span><span class="o">);</span>
	<span class="n">f</span><span class="o">.</span><span class="na">putFavorite</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mh">0xcafebabe</span><span class="o">);</span>
	<span class="n">f</span><span class="o">.</span><span class="na">putFavorite</span><span class="o">(</span><span class="n">Class</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Favorite</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

	<span class="n">String</span> <span class="n">favoriteString</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">getFavorite</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;%s\n&quot;</span><span class="o">,</span> <span class="n">favoriteString</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>

<p>We will get <code>Java</code>.</p>

<p>Notice that <code>Map&lt; Class&lt; ? &gt;, Object&gt;</code> can have any type of key.The value is <code>Object</code>, which means it does not guarantee the correct relationship between key and value.</p>

<p>To solve the problem, we can change <code>favorites.put(type, instance)</code> to <code>favorites.put(type, type.cast(instance))</code>.</p>

<p>Another problem of <code>Favorite</code> is, we cannot call something like <code>pushFavorite(List&lt;String&gt;.class, lst)</code>, because <code>List&lt;String&gt;</code> is non-reifiable. Currently it does not have a satisfying solution. </p>

            
<div class="social">
    <div>
        <a href="https://twitter.com/share" class="twitter-share-button"  data-text="Effective Java 4 - Generics" data-related="allenlsy">Tweet</a>
    </div>
    
    
    <div>
        <div class="fb-like" data-width="150" data-layout="button_count" data-action="like" data-show-faces="true" data-send="false"></div>
    </div>
    
    
    <div>
        <div class="g-plusone" data-size="medium"></div>
    </div>
    
    
    
    <div>
        <a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a>
    </div>
    
</div>

        </section>
        
        <section>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'allenlsy'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
        </section>
        
    </div>
</article>


<footer class="site-footer">
    <div class="container">
      &copy; 2013 &nbsp;  
        
        <nav>
            <a href="http://allenlsy.com">Blog</a> &middot;
            <a href="http://cast.allenlsy.com">Casts</a> &middot;
            
            
        </nav>
        
        <nav class="social">
            
            <a href="https://twitter.com/allenlsy" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter black"></i></a>
            
            
            <a href="http://facebook.com/allenlsy" title="Follow on Facebook" target="_blank"><i class="icon icon-facebook black"></i></a>
                
            <a href="/feed.xml" title="RSS Feed">
                <i class="icon icon-rss black"></i>
            </a>
        </nav>
    </div>
</footer>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="/assets/main.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=253595308025739";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script>
    (function(d, t) {
        var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        g.src = '//hnbutton.appspot.com/static/hn.min.js';
        s.parentNode.insertBefore(g, s);
    }(document, 'script'));
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24647338-1', '');
  ga('send', 'pageview');
</script>

</body>
</html>
